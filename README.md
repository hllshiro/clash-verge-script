# clash-verge-script
"Global Extend Script" for "Clash Verge".


## 脚本简介
本脚本是 Clash Verge 客户端的「全局扩展脚本」，核心作用是**自动处理 Clash 代理规则**：通过「前置特定规则 + 移除冲突旧规则」的逻辑，帮助用户实现规则优先级管理，无需手动删除重复或冲突的规则，提升代理配置的灵活性和效率。

适用于需要固定优先使用某些节点、或强制部分域名直连的场景，例如：优先让 Google、GCP 相关域名走 AI 节点，Bing 域名直接连接。


## 核心功能
1. **规则前置**：将用户定义的关键规则（如直连规则、专用节点规则）优先加载，确保其生效顺序高于原有配置中的规则。
2. **冲突去重**：自动检测并移除原有规则中与「前置规则」冲突的条目（按「规则类型 + 匹配值」判断冲突，避免重复规则干扰）。

## 安装与配置
### 前提条件
- 已安装 Clash Verge 客户端。
- 了解 Clash 基础规则格式（如 `DOMAIN-SUFFIX`、`DOMAIN-KEYWORD` 等规则类型）。

## 注意事项
1. **规则格式正确性**：自定义 `prependRules` 时，需确保每个规则的「逗号分隔格式」正确，缺失参数会导致脚本报错（例如：`DOMAIN-SUFFIX,bing.com` 缺少「策略/节点」参数，需补全为 `DOMAIN-SUFFIX,bing.com,DIRECT`）。
2. **节点名称一致性**：规则中的「节点/策略名称」（如 `🤖 AI`）需与 Clash Verge 中已有的节点名称完全一致（含特殊符号、空格），否则规则会失效。

## 常见问题（FAQ）
### Q1：脚本生效后，冲突规则未被移除怎么办？
A1：检查以下两点：
- 原有规则与前置规则的「规则类型 + 匹配值」是否完全一致（例如：`DOMAIN-SUFFIX,bing.com` 和 `DOMAIN,bing.com` 类型不同，不判定为冲突）。
- 规则中是否存在多余空格（例如：`DOMAIN-SUFFIX, bing.com` 含空格，需改为 `DOMAIN-SUFFIX,bing.com`）。

### Q2：如何让某个域名「不使用前置规则」？
A2：无需特殊操作，仅在 `prependRules` 中定义需要优先生效的规则即可；未在 `prependRules` 中出现的规则，会保留原有逻辑。
